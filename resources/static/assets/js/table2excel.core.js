!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("ExcelJS")):"function"==typeof define&&define.amd?define(["ExcelJS"],t):"object"==typeof exports?exports.Table2Excel=t(require("ExcelJS")):e.Table2Excel=t(e.ExcelJS)}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argb=t.mergeCells=t.cellPosition=t.columnIndex=t.saveAsBlob=void 0;var n=r(1),o=(t.saveAsBlob=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"xlsx",o=n.MIME_TYPES[r];o?e.xlsx.writeBuffer().then(function(e){t.call(void 0,new Blob([e.buffer],{type:o}))}):console.error(r+" file extension is not supported")},function(e){var t="A".charCodeAt(0);return String.fromCharCode(t+e-1)}),l=t.columnIndex=function(e){var t=void 0;if((e+=1)<=26)t=o(e);else{var r=e%26,n=Math.floor(e/26);t=0===r?o(n-1)+o(26):o(n)+o(r)}return t},i=t.cellPosition=function(e,t){return""+l(e)+(t+1)};t.mergeCells=function(e,t,r,n,o){var l=i(t,r),u=i(n,o);return e.mergeCells(l,u),e.getCell(l)},t.argb=function(e){var t=(e=e||"rgb(0,0,0)").split("(")[1].split(")")[0].split(",").map(function(e,t){return 3===t?255*e:e});return 3===t.length&&t.push(255),t.unshift(t.pop()),t.map(function(e){var t=parseInt(e).toString(16);return 1===t.length?"0"+t:t}).join("").toUpperCase()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MIME_TYPES={xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},t.WIDTH_RATIO=.14},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(6)),o=c(r(7)),l=c(r(8)),i=c(r(9)),u=c(r(10)),a=c(r(11));function c(e){return e&&e.__esModule?e:{default:e}}t.default={fontPlugin:n.default,fillPlugin:o.default,formPlugin:l.default,alignmentPlugin:i.default,hyperlinkPlugin:u.default,autoWidthPlugin:a.default}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(4)),o=i(r(2)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));function i(e){return e&&e.__esModule?e:{default:e}}n.default.plugins=o.default,n.default.utils=l,t.default=n.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=a(r(5)),l=r(0),i=r(1),u=a(r(2));function a(e){return e&&e.__esModule?e:{default:e}}var c=["workbookCreated","worksheetCreated","worksheetCompleted","workcellCreated"],f={workbook:{views:[{x:0,y:0,width:1e4,height:2e4,firstSheet:0,activeTab:1,visibility:"visible"}]},widthRatio:i.WIDTH_RATIO,plugins:[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(Object.values(u.default)))},s=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"table",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tables=Array.from("string"==typeof r?document.querySelectorAll(r):r),this.options=Object.assign({},f,n),this.plugins={},c.forEach(function(e){t.plugins[e]=t.options.plugins.filter(function(t){return t[e]}).map(function(t){return t[e]})}),this.pluginContext={}}return n(e,[{key:"_invokePlugin",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.pluginContext=Object.assign({},this.pluginContext,r),this.plugins[e].forEach(function(e){return e.call(t,t.pluginContext)})}},{key:"toExcel",value:function(){var e=this,t=this.tables,r=this.options,n=new o.default.Workbook;return Object.assign(n,r),this._invokePlugin("workbookCreated",{workbook:n,tables:t}),t.forEach(function(t,r){var o=n.addWorksheet("Sheet "+(r+1));e._invokePlugin("worksheetCreated",{worksheet:o,table:t}),e.toSheet(t,o),e._invokePlugin("worksheetCompleted",{worksheet:o,table:t})}),this.workbook=n}},{key:"toSheet",value:function(e,t){var r=this,n=e.rows.length,o=0;if(e.rows.length>0)for(var i=0;i<e.rows[0].cells.length;i++)o+=e.rows[0].cells[i].colSpan;var u=[];Array.from(e.rows).forEach(function(e){Array.from(e.cells).forEach(function(e){u.push({rowRange:{},colRange:{},el:e})})});for(var a=[],c=0;c<n;c++){for(var f=[],s=0;s<o;s++)f.push({cell:null});a.push(f)}for(var d=0,p=0;p<n;p++)for(var v=0;v<o;v++)if(!a[p][v].cell){var g=u[d++],h=g.el,b=h.rowSpan,y=h.colSpan;g.rowRange={from:p,to:p},g.colRange={from:v,to:v};for(var w=p;w<p+b;w++)for(var m=v;m<v+y;m++)a[w][m].cell=g,g.colRange.to=m,g.rowRange.to=w}u.forEach(function(e){var n=e.rowRange,o=e.colRange,i=e.el,u=i.innerText,a=i.value,c=(0,l.mergeCells)(t,o.from,n.from,o.to,n.to),f="undefined"!=typeof Element&&window&&i instanceof Element?getComputedStyle(i):null;c.value=u||(a||""),r._invokePlugin("workcellCreated",{workcell:c,cell:i,rowRange:n,colRange:o,cellStyle:f})})}},{key:"export",value:function(e,t){return this.workbook||this.toExcel(),(0,l.saveAsBlob)(this.workbook,e,t)}}]),e}();t.default=s},function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(0);t.default={workcellCreated:function(e){var t=e.workcell,r=e.cellStyle;if(r){var l=r.fontWeight;t.font=n({},t.font||{},{name:r.fontFamily,color:{argb:(0,o.argb)(r.color)},bold:"bold"===l||+l>600})}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(0);t.default={workcellCreated:function(e){var t=e.workcell,r=e.cellStyle;if(r){var l=(0,o.argb)(r.backgroundColor);t.fill=n({},t.fill||{},"00000000"===l?{type:"pattern",pattern:"none"}:{type:"pattern",pattern:"solid",fgColor:{argb:l}})}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={workcellCreated:function(e){var t=e.workcell,r=e.cell,n=r.children?r.children[0]:null;n&&["INPUT","SELECT","TEXTAREA"].includes(n.tagName)&&(t.value=n.value)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.default={workcellCreated:function(e){var t=e.workcell,r=e.cellStyle,o=r||{verticalAlign:"middle",textAlign:"left"},l=o.verticalAlign,i=o.textAlign;t.alignment=n({},t.alignment||{},{vertical:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=["top","middle","bottom"],r=0;r<t.length;r++)if(e.includes(t[r]))return t[r];return{baseline:"middle",super:"top",sub:"bottom"}[e]}(l),horizontal:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=["right","left","center","justify"],r=0;r<t.length;r++)if(e.includes(t[r]))return t[r]}(i)})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={workcellCreated:function(e){var t=e.workcell,r=e.cell,n=r.children?r.children[0]:null;n&&"A"===n.tagName&&(t.value={text:n.innerText,hyperlink:n.href})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={workcellCreated:function(e){var t=e.worksheet,r=e.colRange,n=(e.cell,e.cellStyle);r&&n&&r.from===r.to&&"auto"!==n.width&&(t.getColumn(r.from+1).width=+n.width.split("px")[0]*this.options.widthRatio)}}}]).default});